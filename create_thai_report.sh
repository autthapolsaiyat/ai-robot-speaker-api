#!/bin/bash

# ข้อความรายงาน
TEXT="คดีที่หนึ่ง
วันที่เกิดเหตุ สอง ธันวาคม สองพันหนึ่งร้อยสิบเอ็ด เวลา สิบห้า นาฬิกา สามสิบนาที
ประเภทคดี ฆ่าเจ้าพนักงาน
สถานีตำรวจ สถานีตำรวจภูธรจะแนะ
สถานที่เกิดเหตุ บริเวณถนนบ้านกูมุง หมู่สอง ตำบลช้างเผือก อำเภอจะแนะ จังหวัดนราธิวาส
พฤติกรรมคดี
วันที่สิบสอง กุมภาพันธ์ สองพันหกร้อยเจ็ดสิบเจ็ด เวลาประมาณสิบห้านาฬิกา เจ้าหน้าที่อาสาสมัครอำเภอจะแนะ ได้ออกเดินทางโดยรถยนต์เกราะจากที่ว่าการอำเภอ มุ่งหน้าไปยังบ้านไอร์บาลอ หมู่หก ตำบลช้างเผือก อำเภอจะแนะ จังหวัดนราธิวาส
ในรถมีเจ้าหน้าที่อาสา สองนาย และนั่งท้ายกระบะอีกสามนาย
เมื่อมาถึงบริเวณถนนบ้านกูมุง ก่อนถึงองค์การบริหารส่วนตำบลช้างเผือก ได้มีคนร้ายจุดชนวนระเบิด
แรงระเบิดทำให้รถยนต์ได้รับความเสียหาย เจ้าหน้าที่เสียชีวิตสองนาย บาดเจ็บสามนาย" 

echo "กำลังสร้างเสียงด้วย gTTS..."
python3 << PYEOF
from gtts import gTTS
import subprocess

text = """$TEXT"""
tts = gTTS(text, lang='th', slow=False)
tts.save('report_thai.mp3')
print("สร้างเสียงเสร็จ: report_thai.mp3")

# แปลง mp3 -> wav
subprocess.run(['ffmpeg', '-y', '-i', 'report_thai.mp3', '-ar', '22050', '-ac', '1', 'report_thai.wav'])
print("แปลงเป็น WAV เสร็จ")
PYEOF

echo "กำลังสร้างวิดีโอด้วย Wav2Lip..."
python Wav2Lip/inference.py \
  --checkpoint_path models/wav2lip_gan.pth \
  --face assets/robot_face.jpg \
  --audio report_thai.wav \
  --outfile report_thai_robot.mp4

echo "เสร็จสิ้น! ไฟล์: report_thai_robot.mp4"
ls -lh report_thai_robot.mp4
